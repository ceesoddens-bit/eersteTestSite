<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Eerste test site Cees</title>
<style>
:root{font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
body{margin:0;min-height:100vh;display:flex;align-items:center;justify-content:center;background:#f5f7fb;padding:1rem}
.card{width:min(760px,95%);background:white;border-radius:12px;box-shadow:0 6px 24px rgba(20,30,60,0.08);padding:28px}
header{display:flex;align-items:center;gap:16px;flex-wrap:wrap}
#logo{width:120px;height:auto;border-radius:0;display:block;object-fit:contain}
h1{margin:0;font-size:20px;flex:1}
p.lead{margin:6px 0 18px;color:#586074}
.buttons{display:flex;gap:10px;flex-wrap:wrap}
.btn{padding:10px 14px;border-radius:8px;border:1px solid #dbe3f2;background:#fff;cursor:pointer;text-decoration:none;color:#0b3b84;font-weight:600;display:inline-flex;align-items:center;gap:8px;transition:background-color 0.2s, opacity 0.2s}
.btn:focus{outline:2px solid #0b3b84;outline-offset:2px}
.btn:hover:not([aria-disabled="true"]){background:#f0f4ff}
.btn[aria-disabled="true"]{opacity:0.5;cursor:not-allowed}
.small{font-size:13px;color:#6b7280}
#message{display:none;margin-top:16px;padding:12px;border-radius:8px;background:#f0f9ff;border:1px solid #0ea5e9;color:#0369a1}
#message.error{background:#fef2f2;border-color:#ef4444;color:#dc2626}
#weerResponse { display: none; margin-top: 10px; padding: 15px; background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px; max-height: 300px; overflow-y: auto; }
#weerResponse h4 { margin: 0 0 10px 0; font-size: 16px; }
#weerResponse pre { margin: 0; white-space: pre-wrap; font-size: 14px; }
footer{margin-top:18px;font-size:13px;color:#94a3b8;text-align:center}
@media (max-width: 480px) {.card{padding:20px};header{flex-direction:column;text-align:center};h1{font-size:18px}}
</style>
</head>
<body>
<main class="card" role="main">
<header>
<img id="logo" src="logo.png" alt="Cees Motion Design logo" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjYwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjx0ZXh0IHg9IjYwIiB5PSIzNSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjIwIiBmaWxsPSIjY2NjIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5Mb2dvPC90ZXh0Pjwvc3ZnPg=='" />
<div>
<h1>Eerste test site Cees</h1>
<p class="lead">Een simpel startpunt — onder de titel vind je drie knoppen: showreel, weerbericht en n8n-test.</p>
</div>
</header>
<section style="margin-top:18px">
<div class="buttons">
<a class="btn" href="https://www.linkedin.com/posts/cees-oddens-61096235a_tijd-voor-een-update-mijn-nieuwste-showreel-activity-7384656566764990464-Pmhq?utm_source=share&utm_medium=member_desktop&rcm=ACoAAFl8guwBCAmJnHiNWf_-U0znjmTkJpJvrsA" target="_blank" rel="noopener noreferrer">▶︎ Showreel</a>
<button class="btn" role="button" id="weerBtn" aria-label="Haal het weerbericht op voor Amsterdam via n8n webhook">☁️ Weerbericht (n8n)</button>
<button class="btn" role="button" id="n8nTestBtn" aria-label="Test de n8n workflow">⚙️ Test n8n workflow</button>
</div>
<p class="small">Tip: klik op een knop om iets op te halen via n8n of een externe API.</p>
<div id="message" role="status" aria-live="polite"></div>
<div id="weerResponse">
    <h4>Response van n8n (weer):</h4>
    <pre id="weerResponseText"></pre>
</div>
</section>
<footer>
<p class="small">Gebouwd met eenvoudige HTML/CSS</p>
</footer>
</main>
<script>
// Utility functie voor messages tonen/verbergen (voor andere knoppen)
function showMessage(text, isError = false) {
  const msgEl = document.getElementById('message');
  msgEl.textContent = text;
  msgEl.className = isError ? 'error' : '';
  msgEl.style.display = 'block';
  setTimeout(() => { msgEl.style.display = 'none'; }, 5000); // Auto-hide na 5s
}
// --- Weerknop (nu precies zoals in de voorbeeldcode: met status, response div, text-first read, etc.) ---
const weerBtn = document.getElementById('weerBtn');
const n8nUrl = "https://ceesodd.app.n8n.cloud/webhook/edda9c43-649c-460b-8c83-e38e24176a30"; // Geüpdatet naar /webhook/ zoals in voorbeeld
weerBtn.addEventListener('click', async () => {
  const button = weerBtn;
  const status = document.getElementById('message');
  const responseDiv = document.getElementById('weerResponse');
  const responseText = document.getElementById('weerResponseText');
 
  button.setAttribute('aria-disabled', 'true');
  button.classList.add('loading');
  button.innerHTML = '<span class="spinner">⏳</span><span class="label">Versturen...</span>'; // Aangepast tekst zoals voorbeeld
  status.textContent = 'Bezig met versturen...';
  status.className = '';
  status.style.display = 'block';
  responseDiv.style.display = 'none'; // Verberg vorige response
 
  try {
    const response = await fetch(n8nUrl, {
      method: 'POST',
      mode: 'cors',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ 
        action: "weerbericht", // Voor je workflow
        stad: "Amsterdam",
        land: "nl",
        message: 'Hallo vanuit de website! (Weer request)',
        timestamp: new Date().toISOString()
      })
    });
   
    const responseBodyText = await response.text(); // Eerst altijd als tekst lezen
   
    let parsedBody;
    try {
      parsedBody = JSON.parse(responseBodyText); // Probeer te parsen als JSON
      // Format JSON mooier
      responseText.textContent = JSON.stringify(parsedBody, null, 2);
    } catch (parseError) {
      // Als geen JSON, toon als platte tekst
      responseText.textContent = responseBodyText;
    }
   
    if (response.ok) {
      status.textContent = 'Webhook succesvol getriggerd!';
      status.className = ''; // Gebruik geen error class voor success
      responseDiv.style.display = 'block';
    } else {
      let errorMsg = responseBodyText || 'Onbekende fout';
      try {
        const parsedError = JSON.parse(responseBodyText);
        errorMsg = parsedError.message || errorMsg;
      } catch {}
      status.textContent = 'Server-fout (' + response.status + '): ' + errorMsg;
      status.className = 'error';
      responseDiv.style.display = 'block'; // Toon error ook in response-veld
    }
  } catch (error) {
    let errorMsg = error.message;
    if (error.name === 'TypeError' && error.message.includes('fetch')) {
      errorMsg = 'Netwerkfout (mogelijk CORS of geen internet). Probeer een lokale server.';
    }
    status.textContent = 'Fout: ' + errorMsg;
    status.className = 'error';
    console.error('Volledige error:', error);
  } finally {
    button.removeAttribute('aria-disabled');
    button.classList.remove('loading');
    button.innerHTML = '☁️ Weerbericht (n8n)';
  }
});
// --- n8n-testknop (ongewijzigd, voor referentie) ---
const n8nBtn = document.getElementById('n8nTestBtn');
const testN8nUrl = "https://ceesodd.app.n8n.cloud/webhook-test/edda9c43-649c-460b-8c83-e38e24176a30"; // Hou oudere URL voor testknop
n8nBtn.addEventListener('click', async () => {
  n8nBtn.setAttribute('aria-disabled', 'true');
  n8nBtn.classList.add('loading');
  n8nBtn.innerHTML = '<span class="spinner">⏳</span><span class="label">Laden...</span>';
 
  try {
    const res = await fetch(testN8nUrl, {
      method: "POST",
      mode: 'cors',
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        naam: "Cees",
        test: "Hallo vanuit je website!",
        timestamp: new Date().toISOString()
      })
    });
   
    if (!res.ok) throw new Error(`HTTP ${res.status}: ${res.statusText}`);
    const data = await res.json();
    showMessage(`Antwoord van n8n: ${JSON.stringify(data, null, 2)}`);
    console.log('n8n response:', data);
  } catch (err) {
    console.error('n8n fetch error:', err);
    showMessage(`Fout bij communicatie met n8n: ${err.message} (Check console voor details.)`, true);
  } finally {
    n8nBtn.removeAttribute('aria-disabled');
    n8nBtn.classList.remove('loading');
    n8nBtn.innerHTML = '⚙️ Test n8n workflow';
  }
});
</script>
</body>
</html>
